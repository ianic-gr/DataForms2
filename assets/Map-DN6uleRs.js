import{v as g,r as l,Q as u,n as i,o as f,aR as h,a as y,g as w,M as b,d as k}from"./index-C5-7oPDj.js";const x={class:"dynamic-map-component"},T={__name:"Map",props:{id:{required:!0,type:String},fields:{type:Array,default:()=>[]},active:{type:Boolean,default:!1}},setup(o){const c=o,d=g("dataformsStore"),r=l({}),a=l(null),s=l(null),p=()=>{r.value=d.getCurrentForm(c.id),a.value=L.map("map").setView([40.6212503,22.9048278],13),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(a.value),s.value=L.marker([40.6212503,22.9048278],{draggable:!0}).addTo(a.value),s.value.on("dragend",function(t){const{lat:e,lng:n}=s.value.getLatLng();r.value.binder.latitude=e,r.value.binder.longitude=n})},m=()=>{let t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"),document.head.appendChild(t);const e=document.createElement("script");e.setAttribute("src","https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"),document.head.appendChild(e),e.onload=()=>p()},v=(t,e)=>{if(!t||!e)return;const n=new L.LatLng(t,e);s.value.setLatLng(n),a.value.setView(n,13)};return u(()=>c.active,async()=>{await i(),a.value&&a.value.invalidateSize()},{immediate:!0}),u(()=>r.value.binder,async({latitude:t,longitude:e})=>{await i(),v(t,e)},{deep:!0}),f(async()=>{await i(),m()}),(t,e)=>{const n=h("DataFormInput");return y(),w("div",x,[e[0]||(e[0]=b("div",{id:"map",class:"mb-8",style:{height:"400px"}},null,-1)),k(n,{formId:o.id,items:o.fields},null,8,["formId","items"])])}}};export{T as _};
